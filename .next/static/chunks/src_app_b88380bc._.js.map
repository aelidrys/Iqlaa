{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file:///home/aelidrys/Desktop/Iqlaa00/src/app/responses/page.tsx"],"sourcesContent":["\n\"use client\";\nimport React, { useEffect, useState } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, getDocs } from 'firebase/firestore';\n\n// TODO: Replace with your Firebase config\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuBbgwcJR0wWJMq7CFV-VgZMqNtFzDPko\",\n  authDomain: \"iqlaa-9b951.firebaseapp.com\",\n  projectId: \"iqlaa-9b951\",\n  storageBucket: \"iqlaa-9b951.firebasestorage.app\",\n  messagingSenderId: \"728888284570\",\n  appId: \"1:728888284570:web:af08032d700e028a029623\",\n  measurementId: \"G-YVR4ERB4BJ\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n// console.log(\"Firebase db: \", db);\ntype ResponseData = {\n    id: string;\n    [key: string]: any;\n};\n\n\n// load questions from the questions.json file\nimport questions from '../questions.json';\n\nfunction getQuestionText(questionId: string, questions: { id: string; question: string }[]) {\n  const q = questions.find(q => q.id === questionId);\n  return q ? q.question : \"Unknown question\";\n}\n\n\n\ntype Question = {\n  id: string;\n  question: string;\n  type: string;\n  options?: string[];\n};\nconst _questions: Question[] = questions.questions || [];\n\n\n\n\n\n\nconst Responses: React.FC = () => {\n  const [responses, setResponses] = useState<ResponseData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState<any>({});\n\n  useEffect(() => {\n    const fetchResponses = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, 'users'));\n        const data = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          ...doc.data(),\n        }));\n        setResponses(data);\n        console.log(\"Fetched responses: \", data);\n      } catch (error) {\n        console.error('Error fetching responses:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchResponses();\n  }, []);\n\n  useEffect(() => {\n    // Calculate stats after responses are loaded\n    const newStats: any = {};\n    _questions.forEach(q => {\n      if (q.type === \"multiple_choice\" && q.options) {\n        newStats[q.id] = {};\n        q.options.forEach(option => {\n          newStats[q.id][option] = 0;\n        });\n      }\n    });\n    responses.forEach(userResponse => {\n      userResponse.responses?.forEach((answerObj: any) => {\n        const { questionId, answer } = answerObj;\n        if (newStats[questionId] && newStats[questionId][answer] !== undefined) {\n          newStats[questionId][answer]++;\n        }\n      });\n    });\n    setStats(newStats);\n    if (Object.keys(newStats).length > 0) {\n      console.log(\"Stats: \", newStats);\n    }\n  }, [responses]);\n\n  if (loading) return <div>Loading...</div>;\n  // clculate totale user responses\n  let totalResponses = `${responses.length}: إجمالي عدد الإجابات `;\n\n  return (\n    <div className='bg-gray-800 flex flex-col items-center justify-center'>\n      <h2 className='mt-10 mb-2 text-4xl font-bold text-center mb-10' style={{color: \"cyan\"}}>{totalResponses}</h2>\n      <ul className='w-[50%]' style={{ minWidth: 300 }}>\n        {_questions.filter(q => q.type === 'multiple_choice').map(q => (\n          <li key={q.id} className='mb-5 bg-gray-500 rounded p-3'>\n            <div className='font-bold text-white text-center mb-4' style={{color: \"#dbd8d8ff\"}}>{q.question} pp</div>\n            <ul>\n              {q.options && q.options.map(option => {\n                const count = stats[q.id]?.[option] ?? 0;\n                const total: any = Object.values(stats[q.id] || {}).reduce((a, b) => Number(a) + Number(b), 0);\n                const percent = total > 0 ? (count / total) * 100 : 0;\n\n                return (\n                  <li key={option} className='mb-1'>\n                    <div className='relative w-full'>\n                      {/* Default full bar */}\n                      <div className='absolute h-full w-full rounded bg-gray-300' style={{zIndex: 0}} />\n                      {/* Percentage bar */}\n                      <div className='absolute left-0 top-0 h-full rounded bg-green-600' style={{width: `${percent}%`, zIndex: 1, transition: 'width 0.5s'}} />\n                      {/* Text content */}\n                      <div className='relative z-10 pl-2 font-bold flex items-center h-full w-full text-black'>\n                        <span className='text-white'>{count}/{total}</span>\n                        <span className='mr-5 ml-5'>{option}</span>\n                        <span>{percent.toFixed(1)}%</span>\n                      </div>\n                    </div>\n                  </li>\n                );\n              })}\n            </ul>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Responses;"],"names":[],"mappings":"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","debugId":null}}]
}