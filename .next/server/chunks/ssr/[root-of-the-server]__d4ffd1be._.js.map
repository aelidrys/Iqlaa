{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///home/aelidrys/Desktop/Iqlaa00/src/app/responses/page.tsx"],"sourcesContent":["\n\"use client\";\nimport React, { useEffect, useState } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, getDocs } from 'firebase/firestore';\n\n// TODO: Replace with your Firebase config\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuBbgwcJR0wWJMq7CFV-VgZMqNtFzDPko\",\n  authDomain: \"iqlaa-9b951.firebaseapp.com\",\n  projectId: \"iqlaa-9b951\",\n  storageBucket: \"iqlaa-9b951.firebasestorage.app\",\n  messagingSenderId: \"728888284570\",\n  appId: \"1:728888284570:web:af08032d700e028a029623\",\n  measurementId: \"G-YVR4ERB4BJ\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n// console.log(\"Firebase db: \", db);\ntype ResponseData = {\n    id: string;\n    [key: string]: any;\n};\n\n\n// load questions from the questions.json file\nimport questions from '../questions.json';\n\nfunction getQuestionText(questionId: string, questions: { id: string; question: string }[]) {\n  const q = questions.find(q => q.id === questionId);\n  return q ? q.question : \"Unknown question\";\n}\n\n\n\ntype Question = {\n  id: string;\n  question: string;\n  type: string;\n  options?: string[];\n};\nconst _questions: Question[] = questions.questions || [];\n\n\n\n\n\n\nconst Responses: React.FC = () => {\n  const [responses, setResponses] = useState<ResponseData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState<any>({});\n\n  useEffect(() => {\n    const fetchResponses = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, 'users'));\n        const data = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          ...doc.data(),\n        }));\n        setResponses(data);\n        console.log(\"Fetched responses: \", data);\n      } catch (error) {\n        console.error('Error fetching responses:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchResponses();\n  }, []);\n\n  useEffect(() => {\n    // Calculate stats after responses are loaded\n    const newStats: any = {};\n    _questions.forEach(q => {\n      if (q.type === \"multiple_choice\" && q.options) {\n        newStats[q.id] = {};\n        q.options.forEach(option => {\n          newStats[q.id][option] = 0;\n        });\n      }\n    });\n    responses.forEach(userResponse => {\n      userResponse.responses?.forEach((answerObj: any) => {\n        const { questionId, answer } = answerObj;\n        if (newStats[questionId] && newStats[questionId][answer] !== undefined) {\n          newStats[questionId][answer]++;\n        }\n      });\n    });\n    setStats(newStats);\n    if (Object.keys(newStats).length > 0) {\n      console.log(\"Stats: \", newStats);\n    }\n  }, [responses]);\n\n  if (loading) return <div>Loading...</div>;\n  // clculate totale user responses\n  let totalResponses = `${responses.length}: إجمالي عدد الإجابات `;\n\n  return (\n    <div className='bg-gray-800 items-center justify-center mx-auto p-10'>\n      <h2 className='mt-10 mb-2 text-4xl font-bold text-center mb-10' style={{color: \"cyan\"}}>{totalResponses}</h2>\n      <ul className='w-[50%] mx-auto'>\n        {_questions.filter(q => q.type === 'multiple_choice').map(q => (\n          <li key={q.id} className='mb-5 bg-gray-500 rounded p-3'>\n            <div className='font-bold text-white text-center mb-4' style={{color: \"#dbd8d8ff\"}}>{q.question}</div>\n            <ul style={{ marginLeft: 20 }}>\n              {q.options && q.options.map(option => {\n                const count = stats[q.id]?.[option] ?? 0;\n                const total: any = Object.values(stats[q.id] || {}).reduce((a, b) => Number(a) + Number(b), 0);\n                const percent = total > 0 ? (count / total) * 100 : 0;\n\n                return (\n                  <li key={option} className='mb-1'>\n                    <div className='relative w-full' style={{height: 32, minWidth: 200}}>\n                      {/* Default full bar */}\n                      <div className='absolute left-0 top-0 h-full w-full rounded bg-gray-300' style={{zIndex: 0}} />\n                      {/* Percentage bar */}\n                      <div className='absolute left-0 top-0 h-full rounded bg-green-600' style={{width: `${percent}%`, zIndex: 1, transition: 'width 0.5s'}} />\n                      {/* Text content */}\n                      <div className='relative z-10 pl-2 font-bold flex items-center h-full w-full text-black'>\n                        <span className='text-white'>{count}/{total}</span>\n                        <span className='mr-5 ml-5'>{option}</span>\n                        <span>{percent.toFixed(1)}%</span>\n                      </div>\n                    </div>\n                  </li>\n                );\n              })}\n            </ul>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Responses;"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AAAA;AAsBA,8CAA8C;AAC9C;AA1BA;;;;;AAKA,0CAA0C;AAC1C,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,MAAM,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;AAC1B,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE;;AAWxB,SAAS,gBAAgB,UAAkB,EAAE,SAA6C;IACxF,MAAM,IAAI,UAAU,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IACvC,OAAO,IAAI,EAAE,QAAQ,GAAG;AAC1B;AAUA,MAAM,aAAyB,+FAAA,CAAA,UAAS,CAAC,SAAS,IAAI,EAAE;AAOxD,MAAM,YAAsB;IAC1B,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAkB,EAAE;IAC7D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAO,CAAC;IAEzC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,iBAAiB;YACrB,IAAI;gBACF,MAAM,gBAAgB,MAAM,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,IAAI;gBACnD,MAAM,OAAO,cAAc,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;wBAC1C,IAAI,IAAI,EAAE;wBACV,GAAG,IAAI,IAAI,EAAE;oBACf,CAAC;gBACD,aAAa;gBACb,QAAQ,GAAG,CAAC,uBAAuB;YACrC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,6BAA6B;YAC7C,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG,EAAE;IAEL,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,6CAA6C;QAC7C,MAAM,WAAgB,CAAC;QACvB,WAAW,OAAO,CAAC,CAAA;YACjB,IAAI,EAAE,IAAI,KAAK,qBAAqB,EAAE,OAAO,EAAE;gBAC7C,QAAQ,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC;gBAClB,EAAE,OAAO,CAAC,OAAO,CAAC,CAAA;oBAChB,QAAQ,CAAC,EAAE,EAAE,CAAC,CAAC,OAAO,GAAG;gBAC3B;YACF;QACF;QACA,UAAU,OAAO,CAAC,CAAA;YAChB,aAAa,SAAS,EAAE,QAAQ,CAAC;gBAC/B,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG;gBAC/B,IAAI,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,WAAW,CAAC,OAAO,KAAK,WAAW;oBACtE,QAAQ,CAAC,WAAW,CAAC,OAAO;gBAC9B;YACF;QACF;QACA,SAAS;QACT,IAAI,OAAO,IAAI,CAAC,UAAU,MAAM,GAAG,GAAG;YACpC,QAAQ,GAAG,CAAC,WAAW;QACzB;IACF,GAAG;QAAC;KAAU;IAEd,IAAI,SAAS,qBAAO,8OAAC;kBAAI;;;;;;IACzB,iCAAiC;IACjC,IAAI,iBAAiB,GAAG,UAAU,MAAM,CAAC,sBAAsB,CAAC;IAEhE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;gBAAkD,OAAO;oBAAC,OAAO;gBAAM;0BAAI;;;;;;0BACzF,8OAAC;gBAAG,WAAU;0BACX,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK,mBAAmB,GAAG,CAAC,CAAA,kBACxD,8OAAC;wBAAc,WAAU;;0CACvB,8OAAC;gCAAI,WAAU;gCAAwC,OAAO;oCAAC,OAAO;gCAAW;0CAAI,EAAE,QAAQ;;;;;;0CAC/F,8OAAC;gCAAG,OAAO;oCAAE,YAAY;gCAAG;0CACzB,EAAE,OAAO,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,CAAA;oCAC1B,MAAM,QAAQ,KAAK,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,OAAO,IAAI;oCACvC,MAAM,QAAa,OAAO,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,IAAM,OAAO,KAAK,OAAO,IAAI;oCAC5F,MAAM,UAAU,QAAQ,IAAI,AAAC,QAAQ,QAAS,MAAM;oCAEpD,qBACE,8OAAC;wCAAgB,WAAU;kDACzB,cAAA,8OAAC;4CAAI,WAAU;4CAAkB,OAAO;gDAAC,QAAQ;gDAAI,UAAU;4CAAG;;8DAEhE,8OAAC;oDAAI,WAAU;oDAA0D,OAAO;wDAAC,QAAQ;oDAAC;;;;;;8DAE1F,8OAAC;oDAAI,WAAU;oDAAoD,OAAO;wDAAC,OAAO,GAAG,QAAQ,CAAC,CAAC;wDAAE,QAAQ;wDAAG,YAAY;oDAAY;;;;;;8DAEpI,8OAAC;oDAAI,WAAU;;sEACb,8OAAC;4DAAK,WAAU;;gEAAc;gEAAM;gEAAE;;;;;;;sEACtC,8OAAC;4DAAK,WAAU;sEAAa;;;;;;sEAC7B,8OAAC;;gEAAM,QAAQ,OAAO,CAAC;gEAAG;;;;;;;;;;;;;;;;;;;uCAVvB;;;;;gCAeb;;;;;;;uBAxBK,EAAE,EAAE;;;;;;;;;;;;;;;;AA+BvB;uCAEe","debugId":null}}]
}